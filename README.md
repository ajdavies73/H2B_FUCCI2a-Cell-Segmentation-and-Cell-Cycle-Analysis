# H2B_FUCCI2a Cell Segmentation and Cell Cycle Analysis

This repository contains two example workflows for segmentation of nuclei in epifluorescence images of live H2B_FUCCI2a_MCF7 cells, followed by per-nucleus and background measurements of fluorescence intensity in the RFP and YFP channels of the image. These values can be used to assess the relative levels of mCherry-hCdt1 and mVenus-hGeminin in each nucleus, from which the cell cycle position of individual cells in an image can be determined. This data is then used to assess changes in overall cell cycle distribution of a population of cells relative to control based on the relative proportions of 'red' (G1 phase), 'green' (S/G2/M phase), 'yellow' (early S phase) and 'no-colour' nuclei (G0).

This repository showcases the basis of these two workflows, an automated method using a purpose-built CellProfiler pipeline and a manual method for ImageJ/FIJI. Step-by-step instructions are provided for each method. ALl programs/scripts are available to download from the appropriate folders in the repository, and example datasets and analyses are also provided in these folders.

These workflows were developed in the Lindon group at the University of Cambridge (https://www.phar.cam.ac.uk/research/lindon) to automate segmentation of nuclei and measurement of per-nucleus mCherry-hCdt1 and mVenus-hGeminin fluorescence across a large number of live-cell epifluorescence images obtained from an Olympus IX81 microscope with a 40X NA 1.3 oil immersion objective. However, the workflows presented could also be applied to other FUCCI2a imaging data.

### What's in this repository?
**Section 1A** - Files needed for CellProfiler method to automate segmentation of nuclei and measurement of per-nucleus mCherry-hCdt1 and mVenus-hGeminin fluorescence across a large number of live-cell epifluorescence images simultaneously
  - CellProfiler pipeline
  - R script for merging images (.TIFF), often saved in individual folders following microscope image acquisition, into a single folder containing all .TIFF files for one experiment. This allows batch uploading of image files into CellProfiler for simultaneous analysis of all images obtained for a single condition or for all conditions in an experiment.
  - Example Excel spreadsheet for organising intensity results generated by CellProfiler for a whole experiment, with individual sheets within for each condition. The spreadsheet also contains a sheet per condition for per-image background intensity measurements, and allows automatic calculation of background-corrected mean intensity values using a simple formula in Excel.
  - Example CSV file into which per-nucleus background-corrected mean intensity values calculated above are copied for each single condition in an experiment. This file is used downstream to classify nucleus colours in the image and perform cell cycle phase distribution analyses.
  
**Section 1B** - Word document describing the protocol for manual segmentation of nuclei and measurement of per-nucleus mCherry-hCdt1 and mVenus-hGeminin fluorescence in ImageJ

**Section 2** - Example downstream analyses that can be performed on data obtained from CellProfiler or ImageJ image analysis in order to assess cell cycle phase distribution of a sample of cells in each image
  - R script for setting thresholds for background-corrected mCherry-hCdt1 and mVenus-hGeminin fluorescence levels in order to classify individual nuclei as 'red' (G1 phase), 'green' (S/G2/M phase), 'yellow' (early S phase) and 'no-colour' nuclei (G0). This script also calculates the proportion of nuclei in the total sample of each colour and therefore in each phase of the cell cycle, and plots as a stacked bar graph.
  - Example Excel spreadsheet containing data obtained from either of the two methods above, used to create graphs of per-nucleus values of mVenus-hGeminin intensity against mCherry-hCdt1 intensity, producing a graphical representation of distribution of all cells from a single condition across the cell cycle based on their relative positions on the two axes.
  - Word document describing additional methods of cell cycle analysis based on the data above with examples and protocols. These include analysing changes in mean mCherry/mVenus fluorescence intensity ratios for each population, and frequency distributions of single-cell mCherry/mVenus ratios to visualise changes in the distribution of the population of cells relative to control based on the gradient of the frequency distribution.

## Introduction to the H2B_FUCCI2a reporter system in H2B_FUCCI2a_MCF7 cells

H2B_FUCCI2a_MCF7 is a human breast adenocarcinoma cell line stably expressing the tricistronic Fluorescent Ubiquitination-based Cell-cycle Indicator (FUCCI) 2a reporter system, as shown in Fig. 1 below. This was generated using the Invitrogen™ FlpIn™ system (Matthew Ford, University of Edinburgh, 2017, https://era.ed.ac.uk/handle/1842/23658; Mort et al., 2014, https://doi.org/10.4161/15384101.2015.945381). This reporter system consists of the coding sequences of mCerulean fused to histone H2B (mCerulean-H2B), mCherry fused to amino acid residues 30-120 of hCdt1 (mCherry-hCdt1(30/120), henceforth referred to as mCherry-hCdt1) and mVenus fused to amino acid residues 1-110 of hGeminin (mVenus-hGeminin(1/110), henceforth referred to as mVenus-hGeminin). These coding sequences are fused by those of porcine Teschovirus-1 2a (P2a) and Thosea asigna virus 2a (T2a) self-cleaving peptides, which separate the three fusion proteins following translation. Expression of this construct is under the control of a CAG constitutive promoter, and cells express equimolar quantities of mCerulean-H2B, mCherry-hCdt1 and mVenus-hGeminin.

Endogenous Cdt1, a nuclear protein, increases in abundance from late mitosis through G1 phase to early S phase, then is targeted for degradation by SCF(Skp2) E3 ubiquitin ligase at the G1/S phase transition. Undegraded Cdt1 is inhibited by geminin, a nuclear protein, whose abundance increases from S phase through G2 phase to early mitosis before being targeted for degradation by APC/C(Cdh1) E3 ligase. These E3 ligases in turn control the activity of the other, with Skp2 targeted for degradation in early G1 phase by APC/C(Cdh1) (Bashir et al., 2004, https://doi.org/10.1038/nature02330), leading to peak activity in S/G2. Active SCF in complex with β-TRCP targets Cdh1 for degradation at the G1/S transition (Fukushima et al., 2013, https://doi.org/10.1016/j.celrep.2013.07.031), leading to peak activity in late M/G1. 

This results in an accumulation of the mCherry-hCdt1 probe in G1 and accumulation of the mVenus-hGeminin probe in S/G2/M phases. H2B_FUCCI2a_MCF7 cells therefore fluoresce red in G1, yellow in early S (where both mCherry-hCdt1 and mVenus-hGeminin are detectable) and green in late S/G2/M phases. By analysing the relative fluorescence of mCherry-hCdt1 and mVenus-hGeminin, and thus their relative abundances, it is possible to estimate the cell cycle phase of each individual cell. This can be used to assess changes in overall cell cycle distribution of a population of cells relative to control.

<br>
<img src="https://github.com/user-attachments/assets/53db4b53-6f66-4c51-bb09-ac9e11d1d791" width="600">
<img src="https://github.com/user-attachments/assets/823e9d71-392a-4904-9fb9-36390cbf7aad" width="600">
<br>

_**Fig. 1: H2B_FUCCI2a_MCF7 cells expressing the H2B_FUCCI2a tricistronic cell cycle reporter system.** **(A)** Schematic depiction of the H2B_FUCCI2a tricistronic construct stably expressed by the H2B_FUCCI2a_MCF7 cell line used in this experiment. Figure created with BioRender.com. **(B)** Schematic representation of the overall ‘colour’ of the H2B_FUCCI2a_MCF7 cell nuclei throughout the cell cycle based on the relative levels of mCherry-hCdt1 and mVenus-hGeminin. Figure created with BioRender.com. **(C)** Representative 40X epifluorescence image of a sample of GL2i-treated cells, showing the differential interference contrast (DIC) image overlaid with the epifluorescence images of mCerulean-H2B, mCherry-hCdt1 and mVenus-hGeminin. **(D)** Merge of the DIC image and the epifluorescence images in each of the three channels. **(E)** Merge of the DIC image and the epifluorescence images in the RFP (mCherry-hCdt1) and YFP (mVenus-hGeminin) channels, showing the overall ‘colour’ of the nuclei in the sample based on the relative levels of mCherry-hCdt1 and mVenus-hGeminin in each cell. Arrow 1 demonstrates a ‘green’ nucleus in S/G2/M phase in which the fluorescent signal and thus level of mVenus-hGeminin exceeds that of mCherry-hCdt1; arrow 2 demonstrates a ‘red’ nucleus in G1 phase in which the fluorescent signal and thus level of mCherry-hCdt1 exceeds that of mVenus-hGeminin; arrow 3 demonstrates a ‘yellow’ nucleus in early S phase in which the fluorescent signals of mVenus-hGeminin and mCherry-hCdt1 are approximately equal. **(F)** Merge of the epifluorescence images in the RFP (mCherry-hCdt1) and YFP (mVenus-hGeminin) channels. All scale bars represent 50 μm._

# Section 1 - Methods to obtain per-nucleus and background fluorescence intensities in each channel

1. CellProfiler pipeline
2. ImageJ segmentation method

Highlight advantages/disadvantages of each.

## Section 1A - CellProfiler Method

### CellProfiler pipeline

CellProfiler pipeline developed by Amelie Davies, February 2024, for segmentation of nuclei of H2B_FUCCI2a_MCF7 live cell epifluorescence images (cell line developed and described by Matthew Ford, University of Edinburgh, 2017 and Mort et al., 2014). The pipeline then measures fluorescent intensity of each channel in each nucleus automatically, as well as in a manually identified background region. The data is outputted as .csv files, and can be used to assess the position of each cell in the cell cycle based on the relative fluorescent intensities in the RFP and YFP channels, corresponding to mCherry-hCdt1 and mVenus-hGeminin levels respectively.

### Example Excel spreadsheet for pooling results from different conditions and background subtraction

### Example CSV file for single condition background subtracted per-nucleus fluorescence intensities for thresholding

### R script to merge images into a single folder

This script can be used to merge several TIFF files into a single folder containing all image files, where each TIFF file is stored by the microscope/MicroManager in separate folders. This allows batch uploading of image files into the CellProfiler pipeline (e.g. to allow automatic analysis of all images for a single condition simultaneously).

N.B. the source directory containing image folders and the desired target directory for all image files will need to be manually specified according to your computer and file structure.

## Section 1B - ImageJ/FIJI Method

# Section 2 - Analysing per-nucleus intensity data to assess cell cycle phases and progression

## FUCCI thresholding code

This script can be used to classify nuclei from a single condition as red (corresponding to G1 phase), green (S/G2/M phase), yellow (S phase) or no-colour (G0). The proportions of nuclei of each colour in the sample are calculated and plotted as a stacked bar chart.

N.B. your .csv file for the condition to be analysed must be formatted as two columns with the headers 'RFPminusBG' and 'YFPminusBG'. These should contain the per-nucleus mean intensities of RFP and YFP fluorescence with the background RFP and YFP fluorescence intensity for the image subtracted respectively. Each row in the file should represent a single nucleus.

You may need to install the package 'tidyverse' before running this script; this can be done using the command install.packages("tidyverse") in the console.

Graphical representation:
<br>
<br>
<img src="https://github.com/user-attachments/assets/25adf5d9-72d8-42d7-9618-e6a83d7bb006" width="700">
<br>
_**Fig. 2: Schematic representation of the method used to determine the overall 'colour' of the nucleus of a single H2B_FUCCI2a_MCF7 cell.** Orange dashed lines indicate the mean mCherry or mVenus fluorescence intensity values across the population of control cells (GL2i-transfected) for each biological replicate of the experiment. Nuclei were classified as ‘red’ (corresponding to G1 phase cells) if their mean mCherry-hCdt1 fluorescent signal was greater than the median value for the control population and their mean mVenus-hGeminin fluorescent signal was less than the median for the control population. Nuclei were classified as ‘green’ (corresponding to late S/G2/M phase cells) if their mean mVenus-hGeminin fluorescent signal was greater than the median value for the control population and their mean mCherry-hCdt1 fluorescent signal was less than the median value for the control population. Nuclei were classified as yellow (corresponding to early S phase cells) if both their mean mCherry-hCdt1 and mVenus-hGeminin signals were greater than the median values for the control population. Nuclei were classified as ‘no colour’ where both their mean mCherry-hCdt1 and mVenus-hGeminin signals were less than the median values for the control population._

## Other analysis

Excel - plotting RFP against YFP values for each nucleus, using distribution to estimate cell cycle position of cells
Komolgorov-Smirnov line plots of RFP/YFP ratios against frequency
Plot log(mVenus/mCherry) ratio relative to GL2i

Look at stats for each and example data/figures

## Outro 

Written by Amelie Davies, March 2024 and updated November 2024.
<br>
All files, images and data belong to Lindon Group, Department of Pharmacology, University of Cambridge, UK.
<br>
<br>
&copy; Copyright 2024, Amelie Davies.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0. Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
